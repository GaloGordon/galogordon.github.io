(function(){const $=(id)=>document.getElementById(id);const fmt=(n)=>{if(Number.isNaN(n)||!Number.isFinite(n))return 'â€”';return new Intl.NumberFormat(undefined,{maximumFractionDigits:6}).format(n);};const calc=()=>{const direction=$('direction').value;const balance=parseFloat($('balance').value);const riskPct=parseFloat($('riskPct').value);const entry=parseFloat($('entry').value);const sl=parseFloat($('sl').value);const rr=parseFloat($('rr').value);if([balance,riskPct,entry,sl,rr].some(v=>Number.isNaN(v))){alert(window.t('tools.alert.fill')||'Complete all fields with valid values.');return;}if(riskPct<=0||rr<=0){alert(window.t('tools.alert.positive')||'Risk % and R:R must be > 0.');return;}if((direction==='long'&&sl>=entry)||(direction==='short'&&sl<=entry)){alert(window.t('tools.alert.sl')||'For long, SL must be below entry. For short, above.');return;}const riskAmount=balance*(riskPct/100);const slDist=Math.abs(entry-sl);const positionSize=riskAmount/slDist;let tp;if(direction==='long'){tp=entry+rr*(entry-sl);}else{tp=entry-rr*(sl-entry);}const rewardAmount=riskAmount*rr;$('risk-amount').textContent='$ '+fmt(riskAmount);$('position-size').textContent=fmt(positionSize);$('sl-distance').textContent=fmt(slDist);$('tp-price').textContent=fmt(tp);$('reward-amount').textContent='$ '+fmt(rewardAmount);document.getElementById('results').classList.remove('hidden');};const btn=document.getElementById('calc-btn');if(btn)btn.addEventListener('click',calc);})();